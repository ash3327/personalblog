"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2548],{1132:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var a=s(5017),t=s(4848),i=s(8453);const r={title:"Project: U-Net Segmentation",description:"99.55% pixel accuracy on Carvana dataset",slug:"unet-segmentation",tags:["Project","PyTorch","Segmentation","Computer Vision","Deep Learning"],image:"/img/docs/unet/unet/unet_1.png"},o="Image Segmentation using U-Net",l={authorsImageUrls:[]},c=[{value:"Backup of Old Project (December 2023)",id:"backup-of-old-project-december-2023",level:2},{value:"Setups",id:"setups",level:2},{value:"Experiments",id:"experiments",level:2},{value:"Carvana Dataset (Carvana Image Masking Challenge Dataset) Carvana Image Masking Challenge",id:"carvana-dataset-carvana-image-masking-challenge-dataset-carvana-image-masking-challenge",level:3},{value:"Cityscapes Dataset (Cityscapes Dataset) Cityscapes Dataset",id:"cityscapes-dataset-cityscapes-dataset-cityscapes-dataset",level:3}];function g(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Details:a}=n;return a||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://github.com/ash3327/ImageSegmentation-UNet",children:(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/View_Project-U--Net%20Segmentation-4285F4?style=flat&logo=github&logoColor=white",alt:"View Project"})})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://www.python.org/",children:(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Python-3776AB.svg?logo=python&logoColor=white",alt:"Python"})}),"\r\n",(0,t.jsx)(n.a,{href:"https://pytorch.org/",children:(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/PyTorch-EE4C2C.svg?logo=pytorch&logoColor=white",alt:"PyTorch"})}),"\r\n",(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Artificial%20Intelligence%20(AI)-orange.svg?logo=ai&logoColor=white",alt:"Artificial Intelligence (AI)"}),"\r\n",(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Image%20Segmentation-red.svg?logo=segmentation&logoColor=white",alt:"Image Segmentation"}),"\r\n",(0,t.jsx)(n.a,{href:"https://www.kaggle.com/competitions/carvana-image-masking-challenge",children:(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Kaggle-Carvana%20Image%20Masking%20Challenge-blue.svg?logo=kaggle&logoColor=white",alt:"Carvana Image Masking Challenge"})}),"\r\n",(0,t.jsx)(n.a,{href:"https://www.cityscapes-dataset.com/",children:(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Dataset-Cityscapes%20Dataset-00BFFF.svg?logo=data:image/png;base64,iVBORw0KGg&logoColor=white",alt:"Cityscapes Dataset"})}),"\r\n",(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Last%20Updated-December%202023-green.svg",alt:"Last Updated: December 2023"})]}),"\n",(0,t.jsx)(n.h2,{id:"backup-of-old-project-december-2023",children:"Backup of Old Project (December 2023)"}),"\n",(0,t.jsx)(n.p,{children:"This is a backup of an old project focused on training a U-Net model from scratch for semantic segmentation from scratch on the Cityscapes dataset and Carvana dataset. The images are DOWNSCALED to speed up the training process for learning purposes. The model has been trained and tested with the following results:"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"[!WARNING]\r\nIf you are looking for a high-quality model, this is NOT the place. This is only a practice exercise when I was in year 2."}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"[!NOTE]\r\nTraining is done long ago and some parameters recorded, such as the number of epochs, may not be accurate"}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"[!IMPORTANT]\r\nThis project is done few years ago from the point of writing this documentation. Back then, the training details are not documented properly and the jupyter notebook results are not saved for each experiment. The results are not excellent either. Sorry for the inconvenience."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"setups",children:"Setups"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Environment"}),": Python 3.10.8, PyTorch 2.1.2, CUDA 12.1"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Libraries"}),": See ",(0,t.jsx)(n.code,{children:"requirements-lock.txt"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Folder Layout"}),":","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"data/\r\n  carvana/\r\n    test/\r\n    train/\r\n    train_masks/\r\n    val/\r\n    val_masks/\r\n  cityscapes/\r\n    gtFine/\r\n    leftImg8Bit/\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Data Sources:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Carvana: ",(0,t.jsx)(n.a,{href:"https://www.kaggle.com/competitions/carvana-image-masking-challenge",children:(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Kaggle-Carvana%20Image%20Masking%20Challenge-blue.svg?logo=kaggle&logoColor=white",alt:"Carvana Image Masking Challenge"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Download from the above link"}),"\n",(0,t.jsx)(n.li,{children:"Unzip all zips and organize as described above"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Cityscapes: ",(0,t.jsx)(n.a,{href:"https://www.cityscapes-dataset.com/",children:(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Dataset-Cityscapes%20Dataset-00BFFF.svg?logo=data:image/png;base64,iVBORw0KGg&logoColor=white",alt:"Cityscapes Dataset"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Download the coarse dataset (images and the masks)"}),"\n",(0,t.jsx)(n.li,{children:"Unzip all zips and organize as described above"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Models"}),":","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"models/\r\n  sem_segmentation/\r\n    1703922437_cityscapes/model_1703922437.h5 # cityscapes\r\n    1703926149/model_1703926149.h5 # carvana\n"})}),"\n","Download from: ",(0,t.jsx)(n.a,{href:"https://drive.google.com/drive/folders/1Mgb_YWV__zsQGNryXGvlOa2EaH49WERe",children:(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Google%20Drive-Models-orange.svg?logo=googledrive&logoColor=white",alt:"Google Drive"})})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Training scripts"}),": Run ",(0,t.jsx)(n.code,{children:"main_semantic_segmentation_carvana.py"})," and ",(0,t.jsx)(n.code,{children:"main_semantic_segmentation_cityscape.py"})," as juypter notebooks."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Testing scripts"}),": Run the ",(0,t.jsx)(n.code,{children:"test_semantic_segmentation_carvana.py"})," script as jupyter notebook. Specify the paths of the h5 files in cell [8]."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"experiments",children:"Experiments"}),"\n",(0,t.jsxs)(n.h3,{id:"carvana-dataset-carvana-image-masking-challenge-dataset-carvana-image-masking-challenge",children:["Carvana Dataset (Carvana Image Masking Challenge Dataset) ",(0,t.jsx)(n.a,{href:"https://www.kaggle.com/competitions/carvana-image-masking-challenge",children:(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Kaggle-Carvana%20Image%20Masking%20Challenge-blue.svg?logo=kaggle&logoColor=white",alt:"Carvana Image Masking Challenge"})})]}),"\n",(0,t.jsx)(n.p,{children:"Dataset information"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Original image dimension: 1918 x 1280"}),"\n",(0,t.jsx)(n.li,{children:"Training image dimension: 160 x 240 and 320 x 480"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Validation accuracies (highest)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Validation Pixel Accuracy: ",(0,t.jsx)(n.strong,{children:"0.9955"})]}),"\n",(0,t.jsxs)(n.li,{children:["Validation Dice Score: ",(0,t.jsx)(n.strong,{children:"0.9911"})]}),"\n"]}),"\n",(0,t.jsx)("h3",{align:"center",children:" Results "}),"\n",(0,t.jsx)(n.p,{children:"Results on test set: (Top: Prediction, Bottom: Reference)"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"alt text",src:s(7897).A+"",width:"520",height:"341"})}),"\n",(0,t.jsx)(n.p,{children:"Results on train set: (Top: Prediction, Bottom: Reference)"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"alt text",src:s(2319).A+"",width:"518",height:"341"})}),"\n",(0,t.jsx)(n.p,{children:"Inspection of intermediate layers: (In the order: Prediction, Output of Downsampling Block 1, Output of Bottleneck Block, Output of Upsampling Block 1, Reference)"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"alt text",src:s(2697).A+"",width:"1008",height:"501"})}),"\n",(0,t.jsxs)(a,{children:[(0,t.jsx)("summary",{children:"Details of the experiments"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Normalization: mean 0, std 1\r\nAugments:\r\n        transforms.RandomHorizontalFlip(p=0.5),\r\n        transforms.RandomVerticalFlip(p=0.1),\r\n        transforms.RandomRotation(degrees=35),\r\n\r\n**29/12/2023 17:15: result12_**\r\nDownscaled image dimension: 160 x 240\r\nBatch size: 32\r\nLearning rate: 5e-7\r\nDecay: StepLR: step_size=5, gamma=0.85\r\nLoss: BCEWithLogitsLoss\r\nEpochs: 42\r\nFinal: Test accuracy: 90.9%, Avg loss: 0.403125, Test recall: 0.5831877589225769, precision: 0.980972170829773\r\n\r\n**30/12/2023 08:40: result13_**\r\nDownscaled image dimension: 160 x 240\r\nBatch size: 32\r\nLearning rate: 1e-4\r\nDecay: ReduceLROnPlateau: patience=5\r\nLoss: BCEWithLogitsLoss\r\nEpochs: 50\r\nFinal: Test accuracy: 81.0%, Avg loss: 0.775568, Test recall: 0.1010913997888565, precision: 0.9727051258087158\r\n\r\n**30/12/2023 11:33: result14_**\r\nDownscaled image dimension: 160 x 240\r\nBatch size: 32\r\nLearning rate: 1e-4\r\nDecay: ReduceLROnPlateau: patience=5\r\nLoss: BCEWithLogitsLoss\r\nEpochs: 100\r\nFinal:\r\nTest accuracy: 96.6%, Avg loss: 0.210099, Test recall: 0.9129086136817932, precision: 0.927651584148407\r\n\r\n**30/12/2023 15:47: 1703922437**\r\nDownscaled image dimension: 160 x 240\r\nBatch size: 16\r\nLearning rate: 1e-4\r\nDecay: None\r\nLoss: BCEWithLogitsLoss\r\nTest accuracy: 99.5%, Avg loss: 0.013175, \r\nTest recall: 0.9918522238731384, precision: 0.9872172474861145, dice_score: 0.9895293116569519\r\n\r\n**30/12/2023 16:49: 1703926149**\r\nDownscaled image dimension: 320 x 480\r\nBatch size: 8\r\nLearning rate: 1e-4\r\nDecay: None\r\nLoss: BCEWithLogitsLoss\r\nTest accuracy: 99.6%, Avg loss: 0.009994, \r\nTest recall: 0.9942919611930847, precision: 0.9879629611968994, dice_score: 0.9911173582077026\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"cityscapes-dataset-cityscapes-dataset-cityscapes-dataset",children:["Cityscapes Dataset (Cityscapes Dataset) ",(0,t.jsx)(n.a,{href:"https://www.cityscapes-dataset.com/",children:(0,t.jsx)(n.img,{src:"https://img.shields.io/badge/Dataset-Cityscapes%20Dataset-00BFFF.svg?logo=data:image/png;base64,iVBORw0KGg&logoColor=white",alt:"Cityscapes Dataset"})})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Test Pixel Accuracy: ",(0,t.jsx)(n.strong,{children:"0.8669"})]}),"\n",(0,t.jsx)(n.li,{children:"The code for evaluating the mAP for the cityscape dataset has been lost. The code in this repository does not reflect the true results."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"1704279189_cityscapes/model_1704284109.h5: \r\n\r\n**Documented:** \r\nTest acc: 0.8402184247970581, Test loss: 0.6274673556908965\n"})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(g,{...e})}):g(e)}},2319:(e,n,s)=>{s.d(n,{A:()=>a});const a=s.p+"assets/images/image2-78057b4210e74b5ab7ccbaae64eb9529.png"},2697:(e,n,s)=>{s.d(n,{A:()=>a});const a=s.p+"assets/images/image4-341eb0e84099144c4c517f3738e0f883.png"},5017:e=>{e.exports=JSON.parse('{"permalink":"/personalblog/blog/unet-segmentation","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2022-08-04-unet-segmentation.md","source":"@site/blog/2022-08-04-unet-segmentation.md","title":"Project: U-Net Segmentation","description":"99.55% pixel accuracy on Carvana dataset","date":"2022-08-04T00:00:00.000Z","tags":[{"inline":true,"label":"Project","permalink":"/personalblog/blog/tags/project"},{"inline":true,"label":"PyTorch","permalink":"/personalblog/blog/tags/py-torch"},{"inline":true,"label":"Segmentation","permalink":"/personalblog/blog/tags/segmentation"},{"inline":true,"label":"Computer Vision","permalink":"/personalblog/blog/tags/computer-vision"},{"inline":true,"label":"Deep Learning","permalink":"/personalblog/blog/tags/deep-learning"}],"readingTime":3.15,"hasTruncateMarker":false,"authors":[],"frontMatter":{"title":"Project: U-Net Segmentation","description":"99.55% pixel accuracy on Carvana dataset","slug":"unet-segmentation","tags":["Project","PyTorch","Segmentation","Computer Vision","Deep Learning"],"image":"/img/docs/unet/unet/unet_1.png"},"unlisted":false,"prevItem":{"title":"Project: Deep Q-Learning Agent","permalink":"/personalblog/blog/deep-q-learning-agent"}}')},7897:(e,n,s)=>{s.d(n,{A:()=>a});const a=s.p+"assets/images/image-041267cdfd77e346a9d0e0d7d422bb48.png"},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>o});var a=s(6540);const t={},i=a.createContext(t);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);